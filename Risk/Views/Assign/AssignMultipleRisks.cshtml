@model Risk.ViewModels.AssignMultipleRiskVM
@{
    ViewBag.Title = "AssignMultipleRisks";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<h2>Assign Multiple Risks</h2>
<div class="panel" style="margin-top:30px;">
    <div class="panel-body" style="background-color:white">

        <span class="title">RISK</span>

        <div class="clearfix"></div>
        <div class="divider"></div>
        <br />

        <div>
            <div id="botonera" class="pull-right">
                <input type="submit" class="btn btn-primary" name="BtnSave" value="SAVE" id="BtnSave" />
                <input type="submit" class="btn btn-primary" name="BtnExit" value="EXIT" id="BtnExit" />
            </div>
        </div>

        <div class="clearfix"></div>
        <div class="divider"></div>
        <br />



        <div class="row">
            <div class="col-lg-12 col-md-12" style="width:100%">

                <div class="col-lg-5 col-md-5" style="padding:10px ;width:45%;border: 1px solid #cbcbcb">
                    <div id="tablaRiesgosSinAsignar" class="divDelGrid table-responsive" style="width:100%;height:500px;">
                        @Html.Partial("~/Views/PartialViews/TablaDatos.cshtml", Model.datosTablaSinAsignar)
                    </div>
                </div>                

                <div class="col-lg-2 col-md-2" style="width:10%; height:500px">
                    <div>
                        <input type="button" class="btn btn-primary" name="BtnAsignar" value="<<" id="delStructure" codigo="delStructure" />
                        <input type="button" class="btn btn-primary" name="BtnAsignar" value=">>" id="addStructure" codigo="addStructure" />
                    </div>
                </div>



                <div class="col-lg-5 col-md-5" style="padding:10px ; width:45%;border: 1px solid #cbcbcb">
                    
                            @* DROPDOWN CON TODOS LOS ELEMENTOS DE LA ESTRUCUTURA *@
                            <span class="form-left-label">Structure Code</span>
                            <select class="form-control w100" campos="campos" id="idEstructura">
                                @{ Dictionary<int, string> structureCode = Model.dropDownStructure.structureCode;

                                    foreach (var structure in structureCode) {
                                        if (structure.Key == Model.idEstructura) {
                                            <option value="@structure.Key" selected>@structure.Value </option>
                                        }
                                        <option value="@structure.Key">@structure.Value </option>
                                    }
                                }
                            </select>
                  
                    <div id="datosTablaAsignados" class="divDelGrid table-responsive" style="width:100%;height:500px;">
                        @Html.Partial("~/Views/PartialViews/TablaDatos.cshtml", Model.datosTablaAsignados)
                    </div>
                </div>

            </div>
        </div>

    </div>
</div>

<script>
    $(document).ready(function () {

        // Cambio de nombre de las tablas por defecto (TablaDatos.cshtml) para que sean distintos
        $('#datosTablaAsignados table').attr('id', 'datosTablaAsignados');
        $('#tablaRiesgosSinAsignar table').attr('id', 'tablaRiesgosSinAsignar');


        // Asignacion de las tablas a 'DataTable' para poder usar sus metodos (add)
        var tableAsignados = $('table[id=datosTablaAsignados]').DataTable({
                                "bPaginate": false,
                                "bFilter": false,
                                "bInfo": false,
                                retrieve: true
        })


        var tablaRiesgosSinAsignar = $('table[id=tablaRiesgosSinAsignar]').DataTable({
                                "bPaginate": false,
                                "bFilter": false,
                                "bInfo": false,
                                retrieve: true
        })


        // Eventos botones para añadir o quitar riesgos de una tabla a otra

        $('input[id*="Structure"]').click(function () {

            var selected;
            var tablaAdd;
            var tablaDelete;

            if ($(this).attr('codigo') == "addStructure") {

                selected = $('table[id=tablaRiesgosSinAsignar] tr.selected');                
                tablaAdd = tableAsignados;
                tablaDelete = tablaRiesgosSinAsignar;
            }

            else {
                selected = $('table[id=datosTablaAsignados] tr.selected');
                tablaAdd = tablaRiesgosSinAsignar;
                tablaDelete = tableAsignados;
            }

            selected.remove();

            tablaAdd.row.add([
                selected.find('td')[0].innerHTML,
                selected.find('td')[1].innerHTML,
                selected.find('td')[2].innerHTML,
                selected.find('td')[3].innerHTML,
                selected.find('td')[4].innerHTML,
                selected.find('td')[5].innerHTML,
                selected.find('td')[6].innerHTML,
                selected.find('td')[7].innerHTML
            ]).draw(false);

        })

    });




</script>

<!-- SCRIPTS -->
<script type="text/javascript" src="~/Content/js/jquery/jquery-2.1.1.min.js"></script>
<script type="text/javascript" src="~/Content/js/jquery/jquery.browser.min.js"></script>
<script type="text/javascript" src="~/Content/js/jquery/jquery.easing.1.3.js"></script>
<script type="text/javascript" src="~/Content/js/bootstrap/bootstrap.min.js"></script>
<script type="text/javascript" src="~/Content/js/bootstrap/bootstrap-metis.menu.min.js"></script>
<script type="text/javascript" src="~/Content/js/bootstrap/bootstrap-datepicker.min.js"></script>
<script type="text/javascript" src="~/Content/js/mdetect/mdetect.js"></script>
<script type="text/javascript" src="~/Content/js/fastclick/fastclick.js"></script>
<script type="text/javascript" src="~/Content/js/scripts.js"></script>
<script type="text/javascript" src="~/Content/js/scripts2.js"></script>
<script type="text/javascript" src="~/Content/datetables/jquery.dataTables.min.js"></script>